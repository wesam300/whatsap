# ุดุฑุญ ุณุฌูุงุช PM2 (whatsapp-dashboard)

## ููุฎุต ุณุฑูุน

| ุงูููุน | ุงููุนูู |
|-------|--------|
| **ุฃุฎุทุงุก Puppeteer/Chrome** | ุงููุชุตูุญ ุฃู ุงูุตูุญุฉ ุฃูุบููุช ุฃู ุงููุทุน ุงูุงุชุตุงู ุฃุซูุงุก ุงุณุชุฎุฏุงููุง โ ุงูุชุทุจูู ููุชูุท ุฌุฒุกุงู ูููุง ููุง ูุณูุท. |
| **Detached Frame** | ุงูุตูุญุฉ/ุงูุฅุทุงุฑ ุงูุฐู ุชุณุชุฎุฏูู ุงูููุชุจุฉ ูู ูุนุฏ ููุฌูุฏุงู (ุชู ุฅุบูุงูู ุฃู ุชุบููุฑ ุงูุตูุญุฉ). |
| **JSON parsing error** | ุงูุทูุจุงุช ุงููุฑุณูุฉ ุฅูู `/api/.../send-message` ุชุญุชูู ุนูู JSON ุบูุฑ ุตุงูุญ (ุญุฑู ุชุญูู ุฏุงุฎู ุงููุต). |
| **ุญุฐู ูุฌูุฏ ุงูุฌูุณุฉ** | ูุญุฏุซ **ููุท** ุนูุฏ ุงุณุชุฏุนุงุก ุญุฐู ุงูุฌูุณุฉ ูู ุงููุงุฌูุฉ (ุฒุฑ ุงูุญุฐู) ุฃู ูู API ุงูุญุฐู. |
| **Failed to restore** | ูุดู ุงุณุชุนุงุฏุฉ ุฌูุณุฉ ุนูุฏ ุจุฏุก ุงูุชุดุบูู (ุบุงูุจุงู ุจุณุจุจ ุฎุทุฃ ุจุฑูุชูููู Chrome). |

---

## 1. ุฃุฎุทุงุก Puppeteer / Chrome (error log)

### ูุงุฐุง ุชุฑู ูู ุงูุณุฌู

- `Attempted to use detached Frame '...'`  
  ูุนูุงูุง: ุงูููุฏ ุญุงูู ุงุณุชุฎุฏุงู ุฅุทุงุฑ (ุตูุญุฉ) ูู ุงููุชุตูุญ ุจุนุฏ ุฃู ุฃุตุจุญ "ูููุตูุงู" (ุงูุตูุญุฉ ุฃูุบููุช ุฃู ุชุบููุฑุช).

- `Protocol error (Network.getResponseBody): No data found for resource`  
  ูุนูุงูุง: ุทูุจ ูู ุจุฑูุชูููู Chrome ููุญุตูู ุนูู body ูุทูุจ ุดุจูุฉุ ูุงูุจูุงูุงุช ูู ุชุนุฏ ูุชููุฑุฉ (ูุซูุงู ุงูุตูุญุฉ ุฃูุบููุช ุฃู ุงููุทุน ุงูุงุชุตุงู).

- `auth timeout`  
  ูุนูุงูุง: ุงูุชูุช ูููุฉ ุงูุชุญูู ูู ุงููููุฉ (ูุงุชุณุงุจ ููุจ ูู ูุฑุฏ ูู ุงูููุช ุงููุชููุน).

- `โ๏ธ [Puppeteer] Caught unhandled rejection (target closed/protocol error)`  
  ูุนูุงูุง: ุชู ุงุตุทูุงุฏ ุฑูุถ ูุนุฏ (unhandled rejection) ูู ุฏุงุฎู Puppeteer ุญุชู ูุง ูุณูุท ุงูุนูููุฉ โ ูุฐุง ูู ุงููุนุงูุฌุฉ ุงูุชู ุฃุถููุงูุง ุณุงุจูุงู.

### ุงูุณุจุจ ุงููุนุชุงุฏ

- ุงููุทุงุน ุงุชุตุงู ูุงุชุณุงุจ ุฃู ุฅุบูุงู ุงูุตูุญุฉ ูู ุฌูุฉ ุงููุณุชุฎุฏู.
- ุจุทุก ุงูุดุจูุฉ ุฃู ุงูุณูุฑูุฑ ูุชูุชูู ุงููููุฉ.
- ุงุณุชูุฑุงุฑ ูุญุงููุฉ ุงุณุชุฎุฏุงู ุงูุนููู ุจุนุฏ ุฅุบูุงู ุงููุชุตูุญ (ูุซูุงู ุฌูุจ ูุญุงุฏุซุงุช/ุฌูุงุช ุงุชุตุงู ุจุนุฏ ุงููุทุงุน).

### ูุงุฐุง ููุนู ุงูุชุทุจูู

- ูุญุฏูุซ ุญุงูุฉ ุงูุฌูุณุฉ ุฅูู `disconnected` ููุญุงูู ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุชููุงุฆูุงู (ุญุณุจ ุงูุฅุนุฏุงุฏุงุช).
- ูุง ูุญุฐู ุงูุฌูุณุฉ ููุง ูุฌูุฏูุง ูู ุชููุงุก ููุณูุ ุงูุญุฐู ููุท ุนูุฏ ุทูุจ ุงูุญุฐู ูู ุงููุงุฌูุฉ ุฃู API.

---

## 2. ุฃุฎุทุงุก ุงูุฌูุณุฉ [49] (ูุญุงุฏุซุงุช / ุฌูุงุช ุงุชุตุงู)

### ูุงุฐุง ุชุฑู

- `[49] ุฎุทุฃ ูู ุงูุญุตูู ุนูู ุงููุญุงุฏุซุงุช (authenticated fallback): Attempted to use detached Frame`
- `[49] ุชุญุฐูุฑ: ูุดู ูู ุงูุญุตูู ุนูู ุฌูุงุช ุงูุงุชุตุงู (authenticated fallback)`

### ุงููุนูู

- ุงูุฌูุณุฉ 49 ูุงูุช ูู ุญุงูุฉ "authenticated" ุฃู "connected"ุ ููู ุงูุตูุญุฉ/ุงูุฅุทุงุฑ ุฃุตุจุญ ูููุตูุงู (ุฃูุบููุช ุฃู ุชุบููุฑุช).
- ุนูุฏ ูุญุงููุฉ ุฌูุจ ุงููุญุงุฏุซุงุช ุฃู ุฌูุงุช ุงูุงุชุตุงูุ Puppeteer ูุฑูู "detached Frame" ูุฃู ุงูุตูุญุฉ ูู ุชุนุฏ ุตุงูุญุฉ ููุงุณุชุฎุฏุงู.

### ุงูุณุจุจ ุงููุนุชุงุฏ

- ุงููุทุงุน ูู ูุงุชุณุงุจ ุฃู ุฅุบูุงู ุงููุชุตูุญ ูู ุฌูุฉ ุงููุณุชุฎุฏู.
- ุฃู ุฅุนุงุฏุฉ ุชุดุบูู/ุฅุบูุงู ุงูุฌูุณุฉ ูู ุงููุงุฌูุฉ ูู ููุณ ููุช ูุญุงููุฉ ุฌูุจ ุงูุจูุงูุงุช.

### ูุงุฐุง ููุนู ุงูุชุทุจูู

- ูุณุฌูู ุงูุฎุทุฃ ููุง ูุณูุท ุงูุนูููุฉ.
- ุงูุฌูุณุฉ ุชูุชูู ุฅูู ุญุงูุฉ ุงููุทุงุน ููููุชุฑุถ ุฃู ุชุนูู ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุงูุชููุงุฆู (ุฅู ูู ุชูู ุงูุฌูุณุฉ ูุชูููุฉ ุฃู ููุชููุฉ).

---

## 3. JSON parsing error (ุทูุจ send-message)

### ูุงุฐุง ุชุฑู

- `JSON parsing error: Bad control character in string literal in JSON at position 68`
- `Request URL: /api//wa_40129.../send-message`
- `Request method: POST`

### ุงููุนูู

- ุงูุทูุจ ุงููุงุฏู ุฅูู ูุณุงุฑ ุฅุฑุณุงู ุงูุฑุณุงูุฉ (ูุซู `/api/.../send-message`) ูุญุชูู ุนูู **body** ุจุตูุบุฉ JSON ุบูุฑ ุตุงูุญุฉ.
- "Bad control character" ูุนูู ูุฌูุฏ ุญุฑู ุชุญูู (ูุซู ุณุทุฑ ุฌุฏูุฏ `\n` ุฃู ุชุงุจ `\t`) **ุฏุงุฎู** ูุต (string) ุจุฏูู escape ุตุญูุญ (ูุฌุจ ุฃู ูููู `\n` ูููุณ ุญุฑู ุงูุณุทุฑ ุงููุนูู ุฏุงุฎู ุงูู string).

### ุงูุณุจุจ

- ูู ุฌูุฉ **ุงูุนููู** (ุชุทุจูู ุฃู ุณูุฑุจุช ูุฑุณู ุงูุทูุจ): ุฅูุง ูุจูู ุงูู JSON ูุฏููุงู ููุถุน ุฃุณุทุฑ ุฌุฏูุฏุฉ ุฃู ุฑููุฒ ุชุญูู ุฏุงุฎู ุงููุตุ ุฃู ูุฑุณู ูุต ุงููุณุชุฎุฏู ููุง ูู ุฏูู ุชูุธูู/escape.

### ุงูุญู

- ุงูุชุฃูุฏ ุฃู ุงูู body ููุฑุณู ูู JSON ุตุญูุญ (ูุซูุงู `JSON.stringify(...)` ูู ุงูุนููู).
- ุนุฏู ูุถุน ุฃุญุฑู ุชุญูู "ุฎุงู" ุฏุงุฎู ุญููู ุงููุต (ูุซู `message` ุฃู `to`); ุงุณุชุจุฏุงููุง ุจููู ููุฑุจุฉ ุฃู ุฅุฒุงูุชูุง ูุจู ุงูุฅุฑุณุงู.

---

## 4. ุญุฐู ูุฌูุฏ ุงูุฌูุณุฉ [39]

### ูุงุฐุง ุชุฑู ูู ุงูุณุฌู

- `[39] ูุญุงููุฉ ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุจุงุณุชุฎุฏุงู ุจูุงูุงุช ุงูุฌูุณุฉ ุงูููุฌูุฏุฉ...`
- `[39] ูุญุงููุฉ ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุจุงุณุชุฎุฏุงู ุจูุงูุงุช ุงูุฌูุณุฉ ุงูููุฌูุฏุฉ (ุงูุญุงูุฉ ุงูุณุงุจูุฉ: disconnected)...`
- `[39] ุจุฏุก ุฅุบูุงู ุงูุฌูุณุฉ ุจุดูู ูุงูู...`
- `[39] ุชู ุฅุบูุงู ุงููุชุตูุญ ุจูุฌุงุญ` / `ุชู ุฅุบูุงู ุงูุนููู ุจูุฌุงุญ` / `ุชู ุฅุบูุงู ุงูุฌูุณุฉ ุจุดูู ูุงูู`
- `[39] ุญุฐู ูุฌูุฏ ุงูุฌูุณุฉ: ...`
- `[39] ุชู ุญุฐู ูุฌูุฏ ุงูุฌูุณุฉ ุจูุฌุงุญ`

### ุงููุนูู

- **"ูุญุงููุฉ ุฅุนุงุฏุฉ ุงูุงุชุตุงู"** ุชุฃุชู ูู ุงููุงุฌูุฉ (ูุซู ููุญุฉ ุงูุชุญูู) ุนูุฏูุง ุชูุชุดู ุฌูุณุฉ ุจุญุงูุฉ `disconnected` ูุชูุตุฏูุฑ ุญุฏุซ ุฅุนุงุฏุฉ ุงุชุตุงู (ูุซูุงู `start_session`).
- **"ุจุฏุก ุฅุบูุงู ุงูุฌูุณุฉ ุจุดูู ูุงูู"** = ุฅุบูุงู ุนููู ุงููุงุชุณุงุจ ูุงููุชุตูุญ (ุฏุงูุฉ ุงูุชุฏููุฑ).
- **"ุญุฐู ูุฌูุฏ ุงูุฌูุณุฉ"** ูุธูุฑ **ููุท** ุนูุฏ ุงุณุชุฏุนุงุก **ุญุฐู ุงูุฌูุณุฉ** ูู:
  - ูุงุฌูุฉ ุงููุณุชุฎุฏู (ุฒุฑ ุญุฐู ุงูุฌูุณุฉ)ุ ุฃู
  - ุทูุจ API: `DELETE /api/sessions/:id`

ูู ุงูููุฏ ุงูุญุงูู ูุง ููุฌุฏ ูุณุงุฑ ุขุฎุฑ ูุญุฐู ูุฌูุฏ ุงูุฌูุณุฉ ุนูุฏ "ุฅุนุงุฏุฉ ุงูุงุชุตุงู" ููุท.

### ูุง ุงูุฐู ูุฏ ูุญุฏุซ ุนูููุงู

1. ุงููุณุชุฎุฏู ููุฑ "ุญุฐู ุงูุฌูุณุฉ" ูุชู ุงุณุชุฏุนุงุก `DELETE /api/sessions/:id` ูุญูุฐู ุงููุฌูุฏ.
2. ุฃู ููุงู ุณูุฑุจุช/ูุงุฌูุฉ ูู ูุณุฎุชู ุงูุฅูุชุงุฌูุฉ ุชุณุชุฏุนู ุญุฐู ุงูุฌูุณุฉ ุนูุฏ "ุฅุนุงุฏุฉ ุงูุงุชุตุงู" (ูููุง ูููุถูู ูุฑุงุฌุนุฉ ุงูููุทู ุญุชู ูุง ููุญุฐู ุฅูุง ุนูุฏ ุฑุบุจุฉ ุงููุณุชุฎุฏู).
3. ุฃู ุชู ุงุณุชุฏุนุงุก ุฅุนุงุฏุฉ ุงุชุตุงู ุซู ูู ููุณ ุงูุฌูุณุฉ ุชู ุงุณุชุฏุนุงุก ุญุฐู (ูู ูุณุชุฎุฏู ุฃู ูู ูุงุฌูุฉ).

ููุชุฃูุฏ: ูุฑุงุฌุนุฉ ูู ูุณุชุฏุนู `DELETE /api/sessions/:id` ูู ุงููุงุฌูุฉ ุฃู ูู ุฃู ุชูุงูู ุฎุงุฑุฌู.

---

## 5. ุงุณุชุนุงุฏุฉ ุงูุฌูุณุงุช ุนูุฏ ุงูุชุดุบูู (Restore)

### ูุงุฐุง ุชุฑู

- `๐ Found 5 sessions to potentially restore`
- `[45] ๐ Restoring session "ุงุฑูุงู"...`
- `[45] Killing 1 associated processes`
- `[45] Destroying client completely` / `Client destroyed successfully`
- ูุงุญูุงู ูู error log: `[45] Failed to restore: undefined`
- ู: `โ๏ธ [Puppeteer] Caught unhandled rejection ... Protocol error (Network.getResponseBody)...`

### ุงููุนูู

- ุนูุฏ ุจุฏุก ุงูุชุดุบูู ูุญุงูู ุงูุชุทุจูู ุงุณุชุนุงุฏุฉ ุงูุฌูุณุงุช ุงููุญููุธุฉ (ูุซูุงู 5 ุฌูุณุงุช).
- ููุฌูุณุฉ 45 ูุชู ุชูุธูู ุนูููุงุช ูุฏููุฉ ุซู ุชุฏููุฑ ุนููู ูุฏูู ุฅู ููุฌุฏุ ุซู ูุญุงููุฉ ุฅูุดุงุก ุนููู ุฌุฏูุฏ ูุชููุฆุชู.
- ุฃุซูุงุก ุงูุชููุฆุฉ ูุญุฏุซ ุฎุทุฃ ุจุฑูุชูููู (ูุซู Network.getResponseBody) ููููุณู ุจุงูุฑูุถ (unhandled rejection) ููุง ูุณูุท ุงูุนูููุฉุ ููู ุงุณุชุนุงุฏุฉ ุงูุฌูุณุฉ 45 ุชูุดู ูุชูุณุฌูู ูู `Failed to restore: undefined`.

### ุงูุณุจุจ ุงููุนุชุงุฏ

- ุธุฑูู ุดุจูุฉ ุฃู ููุงุฑุฏ (ุฐุงูุฑุฉุ CPU) ุนูู ุงูุณูุฑูุฑ.
- ุฃู ุชุนุงุฑุถ ูุน ุนูููุงุช Chrome ูุฏููุฉุ ุงูุชูุธูู (Killing associated processes) ูุญุงูู ุงูุชุฎููู ูู ุฐูู.

### ูุงุฐุง ููุนู ุงูุชุทุจูู

- ูุง ูุญุฐู ุงูุฌูุณุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.
- ุงูุฌูุณุฉ ุชุจูู ูู ุญุงูุฉ ููุงุณุจุฉ (ูุซู `disconnected` ุฃู `connecting`) ููููู ูููุณุชุฎุฏู ุฅุนุงุฏุฉ ุชุดุบูููุง ูู ุงููุงุฌูุฉ ูุงุญูุงู.

---

## 6. ุชุณูุณู ููุทูู ูุณุฌูู (ุจุงุฎุชุตุงุฑ)

1. **ุฃุฎุทุงุก Puppeteer/Chrome ู detached Frame**  
   ุงููุทุงุน ุฃู ุฅุบูุงู ุตูุญุฉ ุฃุซูุงุก ุงูุงุณุชุฎุฏุงูุ ุงูุชุทุจูู ูุณุฌูู ููุง ูุณูุท ุจูุถู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุงูู unhandled rejection.

2. **ุฎุทุฃ JSON ูู send-message**  
   ุงูุนููู ูุฑุณู JSON ุบูุฑ ุตุงูุญ (ุญุฑู ุชุญูู ุฏุงุฎู string)ุ ุงูุญู ูู ุฌูุฉ ุงูุนููู ุจุชุญุณูู ุจูุงุก/ุฅุฑุณุงู ุงูู body.

3. **ุฌูุณุฉ 39: ุฅุนุงุฏุฉ ุงุชุตุงู ุซู ุฅุบูุงู ุซู ุญุฐู ูุฌูุฏ**  
   "ุฅุนุงุฏุฉ ุงูุงุชุตุงู" ูู ุงููุงุฌูุฉ ุซู ุฅุบูุงู ูุงูู ุซู ุญุฐู ุงููุฌูุฏ ูุนูู ุฃู **ุนูููุฉ ุญุฐู ุงูุฌูุณุฉ** (ูู ูุงุฌูุฉ ุฃู API) ุชู ุงุณุชุฏุนุงุคูุงุ ูุง ูุญุฏุซ ุญุฐู ุงููุฌูุฏ ุชููุงุฆูุงู ููุฌุฑุฏ ุฅุนุงุฏุฉ ุงูุงุชุตุงู.

4. **ุฌูุณุฉ 49: LOGOUT ุซู ุฅูุบุงุก ุฅุนุงุฏุฉ ุงูุงุชุตุงู**  
   ูุงุชุณุงุจ ุฃุฑุณู ุงููุทุงุนุงู ุจุณุจุจ ุชุณุฌูู ุฎุฑูุฌุ ุงูุชุทุจูู ุฃุบูู ุงูุนููู ุซู ูุฑุฑ "ุงูุฌูุณุฉ ูุชูููุฉ ุฃู ููุชููุฉุ ุฅูุบุงุก ุฅุนุงุฏุฉ ุงูุงุชุตุงู" โ ููุฐุง ูุชูุงูู ูุน ุงูุฅุนุฏุงุฏ (ุนุฏู ุฅุนุงุฏุฉ ุงูุงุชุตุงู ููุฌูุณุงุช ุงููุชูููุฉ/ุงูููุชููุฉ).

5. **ุงุณุชุนุงุฏุฉ [45] ุนูุฏ ุงูุชุดุบูู**  
   ูุดู ุงูุงุณุชุนุงุฏุฉ ุจุณุจุจ ุฎุทุฃ ุจุฑูุชููููุ ุงูุชุทุจูู ูุธูู ุงูุนููู ููู ูุญุฐู ุงูุฌูุณุฉุ ููููู ุฅุนุงุฏุฉ ุงููุญุงููุฉ ูู ุงููุงุฌูุฉ.

---

## 7. ุชูุตูุงุช ุนูููุฉ

| ุงููุดููุฉ | ุงูุชูุตูุฉ |
|--------|---------|
| ุชูุฑุงุฑ detached Frame / Protocol error | ูุฑุงูุจุฉ ุงุณุชูุฑุงุฑ ุงูุดุจูุฉ ูุงูููุงุฑุฏ (CPU/ุฐุงูุฑุฉ)ุ ุงูุชุฃูุฏ ูู ุนุฏู ุฅุบูุงู ุงูุฌูุณุฉ ูู ุงููุงุฌูุฉ ุฃุซูุงุก ุฌูุจ ุงููุญุงุฏุซุงุช/ุฌูุงุช ุงูุงุชุตุงู. |
| JSON parsing error ูู send-message | ูุฑุงุฌุนุฉ ูู ุนููู ูุฑุณู ุฅูู `/api/.../send-message`: ุงุณุชุฎุฏุงู JSON ุตุญูุญ ูุนุฏู ูุถุน ุฃุญุฑู ุชุญูู ุฎุงู ุฏุงุฎู ุงููุตูุต. |
| ุญุฐู ูุฌูุฏ ุฌูุณุฉ ุฏูู ูุตุฏ | ูุฑุงุฌุนุฉ ุงููุงุฌูุฉ ููู ุงุณุชุฏุนุงุกุงุช `DELETE /api/sessions/:id`ุ ุงูุชุฃูุฏ ุฃู "ุฅุนุงุฏุฉ ุงูุงุชุตุงู" ูุง ุชุณุชุฏุนู ุญุฐู ุงูุฌูุณุฉ. |
| Failed to restore ุนูุฏ ุงูุจุฏุก | ุงุนุชุจุงุฑูุง ูุดู ุงุณุชุนุงุฏุฉ ูุคูุชุ ุงููุณุชุฎุฏู ููููู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฌูุณุฉ ูู ุงููุงุฌูุฉ. ูููู ุฒูุงุฏุฉ ูููุฉ ุงูุชูุธูู ูุจู ุงูุงุณุชุนุงุฏุฉ ุฅู ูุฒู. |

---
*ุขุฎุฑ ุชุญุฏูุซ: 2025-02-24*
